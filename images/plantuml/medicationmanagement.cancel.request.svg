<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="756px" preserveAspectRatio="none" style="width:1714px;height:756px;background:#FFFFFF;" version="1.1" viewBox="0 0 1714 756" width="1714px" zoomAndPan="magnify"><defs/><g><rect fill="#D3D3D3" height="737.2891" style="stroke:#181818;stroke-width:0.5;" width="193" x="956" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="130" x="987.5" y="18.0669">ePA-Aktensystem</text><rect fill="#F5F5DC" height="737.2891" style="stroke:#181818;stroke-width:0.5;" width="346" x="1171" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175" x="1256.5" y="18.0669">ePA-Aktensystem / VAU</text><rect fill="none" height="366.2344" style="stroke:#000000;stroke-width:1.5;" width="1474.5" x="233" y="366.0547"/><rect fill="none" height="147.6641" style="stroke:#000000;stroke-width:1.5;" width="1280" x="243" y="577.625"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="58" x2="58" y1="89.0234" y2="749.2891"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="352" x2="352" y1="89.0234" y2="749.2891"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1052" x2="1052" y1="89.0234" y2="749.2891"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1247" x2="1247" y1="89.0234" y2="749.2891"/><line style="stroke:#0000FF;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1421" x2="1421" y1="89.0234" y2="749.2891"/><rect fill="#3483EB" height="30.2969" rx="2.5" ry="2.5" style="stroke:#3483EB;stroke-width:0.5;" width="67" x="25" y="57.7266"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="32" y="77.7217">PVS/KIS</text><rect fill="#3483EB" height="30.2969" rx="2.5" ry="2.5" style="stroke:#3483EB;stroke-width:0.5;" width="159" x="273" y="57.7266"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145" x="280" y="77.7217">E-Rezept-Fachdienst</text><rect fill="#3483EB" height="30.2969" rx="2.5" ry="2.5" style="stroke:#3483EB;stroke-width:0.5;" width="145" x="980" y="57.7266"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="987" y="77.7217">Information Service</text><rect fill="#EB5E34" height="62.8906" rx="2.5" ry="2.5" style="stroke:#3483EB;stroke-width:0.5;" width="105" x="1195" y="25.1328"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1231.5" y="45.1279">VAU</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="1218" y="61.4248">Session</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="1202" y="77.7217">Management</text><rect fill="#3483EB" height="30.2969" rx="2.5" ry="2.5" style="stroke:#3483EB;stroke-width:0.5;" width="143" x="1350" y="57.7266"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="1357" y="77.7217">Medication Service</text><polygon fill="#1E90FF" points="340.5,116.1563,350.5,120.1563,340.5,124.1563,344.5,120.1563" style="stroke:#1E90FF;stroke-width:1.0;"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="58.5" x2="346.5" y1="120.1563" y2="120.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="65.5" y="115.0903">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="78.5" y="115.0903">Anfrage: Verordnungsdatensatz löschen</text><line style="stroke:#1E90FF;stroke-width:1.0;" x1="352.5" x2="394.5" y1="149.2891" y2="149.2891"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="394.5" x2="394.5" y1="149.2891" y2="162.2891"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="353.5" x2="394.5" y1="162.2891" y2="162.2891"/><polygon fill="#1E90FF" points="363.5,158.2891,353.5,162.2891,363.5,166.2891,359.5,162.2891" style="stroke:#1E90FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="359.5" y="144.2231">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="486" x="372.5" y="144.2231">Durchführen der standardisierten Workflow-Logik des E-Rezept-Fachdienstes</text><polygon fill="#1E90FF" points="69.5,187.4219,59.5,191.4219,69.5,195.4219,65.5,191.4219" style="stroke:#1E90FF;stroke-width:1.0;"/><line style="stroke:#1E90FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63.5" x2="351.5" y1="191.4219" y2="191.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="75.5" y="186.356">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="88.5" y="186.356">Antwort: Erfolg</text><line style="stroke:#1E90FF;stroke-width:1.0;" x1="352.5" x2="394.5" y1="235.6875" y2="235.6875"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="394.5" x2="394.5" y1="235.6875" y2="248.6875"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="353.5" x2="394.5" y1="248.6875" y2="248.6875"/><polygon fill="#1E90FF" points="363.5,244.6875,353.5,248.6875,363.5,252.6875,359.5,248.6875" style="stroke:#1E90FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="359.5" y="223.0552">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="646" x="372.5" y="215.4888">Persistieren der Resource ID des zu stornierenden Verordnungsdatensatzes (aus MedicationRequest)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="352" x="372.5" y="230.6216">in einer Warteschlange für die asynchrone Übertragung</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="898" x="250" y="256.6875"/><path d="M250,256.6875 L316,256.6875 L316,263.6875 L306,273.6875 L250,273.6875 L250,256.6875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="263" y="270.7544">ref</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="619" x="389.5" y="288.8262">Lokalisierung der Service-Endpunkte der ePA und der Akte eines Versicherten (s. Abschn. 4.1, 4.2)</text><polygon fill="#1E90FF" points="1040.5,317.9219,1050.5,321.9219,1040.5,325.9219,1044.5,321.9219" style="stroke:#1E90FF;stroke-width:1.0;"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="352.5" x2="1046.5" y1="321.9219" y2="321.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="359.5" y="316.856">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402" x="372.5" y="316.856">Anfrage: Widerspruchsinformationen zu Versorgungsprozessen</text><polygon fill="#1E90FF" points="363.5,347.0547,353.5,351.0547,363.5,355.0547,359.5,351.0547" style="stroke:#1E90FF;stroke-width:1.0;"/><line style="stroke:#1E90FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="357.5" x2="1051.5" y1="351.0547" y2="351.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="369.5" y="345.9888">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="382.5" y="345.9888">Antwort: Widerspruchsinformationen</text><path d="M233,366.0547 L297,366.0547 L297,373.1875 L287,383.1875 L233,383.1875 L233,366.0547 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="366.2344" style="stroke:#000000;stroke-width:1.5;" width="1474.5" x="233" y="366.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="248" y="379.1216">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="366" x="312" y="378.2651">[Widerspruch zum Versorgungsprozess dgMP vorhanden]</text><line style="stroke:#1E90FF;stroke-width:1.0;" x1="352.5" x2="394.5" y1="404.3203" y2="404.3203"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="394.5" x2="394.5" y1="404.3203" y2="417.3203"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="353.5" x2="394.5" y1="417.3203" y2="417.3203"/><polygon fill="#1E90FF" points="363.5,413.3203,353.5,417.3203,363.5,421.3203,359.5,417.3203" style="stroke:#1E90FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="359.5" y="399.2544">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="673" x="372.5" y="399.2544">Abbruch. Löschen der Resource ID des zu stornierenden Verordnungsdatensatzes aus der Warteschlange</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="233" x2="1707.5" y1="426.3203" y2="426.3203"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="327" x="238" y="436.5308">[Kein Widerspruch zum Versorgungsprozess dgMP]</text><rect fill="none" height="39.1016" style="stroke:#000000;stroke-width:1.5;" width="1073" x="250" y="440.125"/><path d="M250,440.125 L316,440.125 L316,447.125 L306,457.125 L250,457.125 L250,440.125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="263" y="454.1919">ref</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="344" x="614.5" y="472.2637">Login in die Akte des Versicherten (siehe. Abschn. 4.3)</text><polygon fill="#1E90FF" points="1409.5,501.3594,1419.5,505.3594,1409.5,509.3594,1413.5,505.3594" style="stroke:#1E90FF;stroke-width:1.0;"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="352.5" x2="1415.5" y1="505.3594" y2="505.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="359.5" y="500.2935">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="545" x="372.5" y="500.2935">Übermittlung des rxPrescriptionProcessIdentifier in der FHIR Operation per HTTP POST</text><line style="stroke:#1E90FF;stroke-width:1.0;" x1="1421.5" x2="1463.5" y1="549.625" y2="549.625"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="1463.5" x2="1463.5" y1="549.625" y2="562.625"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="1422.5" x2="1463.5" y1="562.625" y2="562.625"/><polygon fill="#1E90FF" points="1432.5,558.625,1422.5,562.625,1432.5,566.625,1428.5,562.625" style="stroke:#1E90FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1428.5" y="536.9927">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="1441.5" y="529.4263">MedicationRequest.status = "cancelled"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="1441.5" y="544.5591">aktualisieren</text><path d="M243,577.625 L307,577.625 L307,584.7578 L297,594.7578 L243,594.7578 L243,577.625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="147.6641" style="stroke:#000000;stroke-width:1.5;" width="1280" x="243" y="577.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="258" y="590.6919">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="112" x="322" y="589.8354">[successful case]</text><polygon fill="#1E90FF" points="363.5,611.8906,353.5,615.8906,363.5,619.8906,359.5,615.8906" style="stroke:#1E90FF;stroke-width:1.0;"/><line style="stroke:#1E90FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="357.5" x2="1420.5" y1="615.8906" y2="615.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="369.5" y="610.8247">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="391.5" y="610.8247">Antwort: Transaktion erfolgreich</text><line style="stroke:#1E90FF;stroke-width:1.0;" x1="352.5" x2="394.5" y1="645.0234" y2="645.0234"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="394.5" x2="394.5" y1="645.0234" y2="658.0234"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="353.5" x2="394.5" y1="658.0234" y2="658.0234"/><polygon fill="#1E90FF" points="363.5,654.0234,353.5,658.0234,363.5,662.0234,359.5,658.0234" style="stroke:#1E90FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="359.5" y="639.9575">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="612" x="381.5" y="639.9575">Löschen der Resource ID des zu stornierenden Verordnungsdatensatzes aus der Warteschlange</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="243" x2="1523" y1="667.0234" y2="667.0234"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="352.5" x2="394.5" y1="704.2891" y2="704.2891"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="394.5" x2="394.5" y1="704.2891" y2="717.2891"/><line style="stroke:#1E90FF;stroke-width:1.0;" x1="353.5" x2="394.5" y1="717.2891" y2="717.2891"/><polygon fill="#1E90FF" points="363.5,713.2891,353.5,717.2891,363.5,721.2891,359.5,717.2891" style="stroke:#1E90FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="359.5" y="691.6567">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="643" x="381.5" y="684.0903">Abbruch. Die Resource ID des zu stornierenden Verordnungsdatensatzes bleibt in der Warteschlange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="381.5" y="699.2231">für eine spätere Übertragung</text><!--MD5=[95738c9ae3c9c784f7eb75b001f0c9ea]
@startuml

skinparam Shadowing false
skinparam ParticipantPadding 20
skinparam BoxPadding 10

skinparam sequence {
    ArrowColor DodgerBlue
    ActorBorderColor DodgerBlue
    LifeLineBorderColor Blue

    ParticipantBackgroundColor #3483eb
    ParticipantBorderColor #3483eb
    ParticipantFontSize 14
    ParticipantFontColor White

    ActorBackgroundColor #3483eb
    ActorFontSize 14
    NoteBackgroundColor #3483eb
}

hide footbox
autonumber

participant "PVS/KIS" as PVS
participant "E-Rezept-Fachdienst" as ERFD

box "ePA-Aktensystem" #LightGray
    participant "Information Service" as IS
end box

box "ePA-Aktensystem / VAU" #Beige
    participant "VAU \nSession \nManagement" as VAU #eb5e34
    participant "Medication Service" as EPA
end box

PVS -> ERFD: Anfrage: Verordnungsdatensatz löschen
ERFD -> ERFD: Durchführen der standardisierten Workflow-Logik des E-Rezept-Fachdienstes
ERFD - -> PVS: Antwort: Erfolg

ERFD -> ERFD: Persistieren der Resource ID des zu stornierenden Verordnungsdatensatzes (aus MedicationRequest)\nin einer Warteschlange für die asynchrone Übertragung

ref over ERFD, IS: Lokalisierung der Service-Endpunkte der ePA und der Akte eines Versicherten (s. Abschn. 4.1, 4.2)

ERFD -> IS: Anfrage: Widerspruchsinformationen zu Versorgungsprozessen
IS - -> ERFD: Antwort: Widerspruchsinformationen

alt Widerspruch zum Versorgungsprozess dgMP vorhanden
    ERFD -> ERFD: Abbruch. Löschen der Resource ID des zu stornierenden Verordnungsdatensatzes aus der Warteschlange
else Kein Widerspruch zum Versorgungsprozess dgMP

    ref over ERFD, VAU: Login in die Akte des Versicherten (siehe. Abschn. 4.3)

    ERFD -> EPA: Übermittlung des rxPrescriptionProcessIdentifier in der FHIR Operation per HTTP POST
    EPA -> EPA: MedicationRequest.status = "cancelled"\naktualisieren

    alt successful case
        EPA - -> ERFD: Antwort: Transaktion erfolgreich
        ERFD -> ERFD: Löschen der Resource ID des zu stornierenden Verordnungsdatensatzes aus der Warteschlange
    else
        ERFD -> ERFD: Abbruch. Die Resource ID des zu stornierenden Verordnungsdatensatzes bleibt in der Warteschlange\nfür eine spätere Übertragung
    end

end

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>