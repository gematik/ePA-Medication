<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1565px" preserveAspectRatio="none" style="width:2008px;height:1565px;background:#FFFFFF;" version="1.1" viewBox="0 0 2008 1565" width="2008px" zoomAndPan="magnify"><defs/><g><rect fill="#87CEEB" height="26.2969" id="_title" style="stroke:#808080;stroke-width:1.0;" width="215" x="895" y="15"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="205" x="900" y="32.9951">$provide-prescription-erp</text><ellipse cx="1161.125" cy="57.2969" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="828" x="747.125" y="141.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="51" x="757.125" y="162.4043">Validate</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="137" x="812.125" y="162.4043">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="949.125" y="162.4043">,</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="957.125" y="162.4043">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1035.125" y="162.4043">,</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1043.125" y="162.4043">Organization</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="1140.125" y="162.4043">and</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="84" x="1168.125" y="162.4043">Practitioner</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="28" x="1256.125" y="162.4043">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1288.125" y="162.4043">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="1413.125" y="162.4043">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="102" x="1433.125" y="162.4043">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="30" x="1535.125" y="162.4043">.part</text><polygon fill="#F1F1F1" points="1099.625,195.2344,1222.625,195.2344,1234.625,207.2344,1222.625,219.2344,1099.625,219.2344,1087.625,207.2344,1099.625,195.2344" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="1099.625" y="211.0425">Validation successfull</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1067.625" y="204.6401">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1234.625" y="204.6401">no</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="448" x="406.25" y="229.2344"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="426.75" y="250.373">Generate</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="489.75" y="250.373">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="113" x="716.75" y="250.373">from the values of</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="416.25" y="264.3418"> </text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="420.25" y="264.3418">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="545.25" y="264.3418">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="102" x="565.25" y="264.3418">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="667.25" y="264.3418">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="86" x="701.25" y="264.3418">authoredOn</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="49" x="791.25" y="264.3418">and the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="439.25" y="278.3105"> </text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="443.25" y="278.3105">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="568.25" y="278.3105">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="102" x="588.25" y="278.3105">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="690.25" y="278.3105">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="724.25" y="278.3105">PresciptionId</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="817.25" y="278.3105">;</text><polygon fill="#F1F1F1" points="385.75,311.1406,874.75,311.1406,886.75,330.3477,874.75,349.5547,385.75,349.5547,373.75,330.3477,385.75,311.1406" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="385.75" y="321.3511">Check if there is a</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123" x="493.75" y="321.3511">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="45" x="620.75" y="321.3511">with the</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="201" x="669.75" y="321.3511">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="870.75" y="321.3511"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="619.75" y="334.1558">and</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="58" x="442.25" y="346.9604">the status</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="39" x="504.25" y="346.9604">active</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="12" x="547.25" y="346.9604">or</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="67" x="563.25" y="346.9604">completed</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="188" x="634.25" y="346.9604">already in the Medication Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="353.75" y="327.7534">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="886.75" y="327.7534">no</text><rect fill="#FFC0CB" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="541" x="11" y="359.5547"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="21" y="380.6934">Add error</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="135" x="84" y="380.6934">OperationOutcome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="177" x="223" y="380.6934">(NO_EXIST or STATUS) to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="404" y="380.6934">Output-Parameters</text><rect fill="none" height="983.0781" style="stroke:#000000;stroke-width:1.5;" width="814" x="572" y="359.5547"/><path d="M659,359.5547 L659,368.8516 L649,378.8516 L572,378.8516 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="575" y="373.5498">transaction</text><rect fill="#F1F1F1" height="99.8438" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="426" x="766" y="395.8516"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="157" x="900.5" y="416.9902">&lt;&lt; Create or Update &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="932.5" y="430.959">Organization</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="776" y="444.9277">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="125" x="808" y="444.9277">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="20" x="933" y="444.9277">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="102" x="953" y="444.9277">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1055" y="444.9277">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1089" y="444.9277">Organization</text><line style="stroke:#181818;stroke-width:1.0;" x1="766" x2="1192" y1="452.7578" y2="452.7578"/><line style="stroke:#181818;stroke-width:1.0;" x1="766" x2="1192" y1="454.7578" y2="454.7578"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="227" x="865.5" y="468.8965">identifier[TelematikID] = TelematikID</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="973" y="482.8652">...</text><rect fill="#F1F1F1" height="99.8438" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="417" x="770.5" y="515.6953"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="157" x="900.5" y="536.834">&lt;&lt; Create or Update &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="84" x="937" y="550.8027">Practitioner</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="780.5" y="564.7715">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="125" x="812.5" y="564.7715">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="20" x="937.5" y="564.7715">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="102" x="957.5" y="564.7715">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1059.5" y="564.7715">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="84" x="1093.5" y="564.7715">Practitioner</text><line style="stroke:#181818;stroke-width:1.0;" x1="770.5" x2="1187.5" y1="572.6016" y2="572.6016"/><line style="stroke:#181818;stroke-width:1.0;" x1="770.5" x2="1187.5" y1="574.6016" y2="574.6016"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="227" x="865.5" y="588.7402">identifier[TelematikID] = TelematikID</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="973" y="602.709">...</text><rect fill="#F1F1F1" height="85.875" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="282" x="838" y="635.5391"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="157" x="900.5" y="656.6777">&lt;&lt; Create or Update &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="115" x="921.5" y="670.6465">PractitionerRole</text><line style="stroke:#181818;stroke-width:1.0;" x1="838" x2="1120" y1="678.4766" y2="678.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="838" x2="1120" y1="680.4766" y2="680.4766"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="160" x="854.5" y="694.6152">practitioner = Reference(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="84" x="1014.5" y="694.6152">Practitioner</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1098.5" y="694.6152">)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="164" x="848" y="708.584">organization = Reference(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1012" y="708.584">Organization</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1105" y="708.584">)</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="580" x="689" y="741.4141"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="773.5" y="762.5527">Generate for</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="857.5" y="762.5527">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="113" x="1071.5" y="762.5527">from the values of</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="699" y="776.5215">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="824" y="776.5215">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="102" x="844" y="776.5215">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="946" y="776.5215">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="980" y="776.5215">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="108" x="1058" y="776.5215">.Id and the Input-</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1166" y="776.5215">PresciptionId</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="794" x="582" y="809.3516"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="592" y="830.4902">Generate for</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="219" x="676" y="830.4902">EPAMedicationUniqueIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="104" x="899" y="830.4902">from the hashed</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1007" y="830.4902">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="1132" y="830.4902">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="102" x="1152" y="830.4902">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="1254" y="830.4902">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1288" y="830.4902">Medication</text><rect fill="#F1F1F1" height="141.75" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="571" x="693.5" y="863.3203"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="90" x="934" y="884.459">&lt;&lt; Create &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="940" y="898.4277">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="783.5" y="912.3965">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="125" x="815.5" y="912.3965">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="20" x="940.5" y="912.3965">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="102" x="960.5" y="912.3965">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1062.5" y="912.3965">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1096.5" y="912.3965">Medication</text><line style="stroke:#181818;stroke-width:1.0;" x1="693.5" x2="1264.5" y1="920.2266" y2="920.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="693.5" x2="1264.5" y1="922.2266" y2="922.2266"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="710" y="936.3652">identifier[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="219" x="770" y="936.3652">EPAMedicationUniqueIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="259" x="989" y="936.3652">] = Value(EPAMedicationUniqueIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="719.5" y="950.334">identifier[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="779.5" y="950.334">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="249" x="989.5" y="950.334">] = Value(RxOriginatorProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="66" x="703.5" y="964.3027">extension[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="769.5" y="964.3027">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="262" x="992.5" y="964.3027">] = Value(RxPrescriptionProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="54" x="922.5" y="978.2715">status =</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="55" x="980.5" y="978.2715">inactive</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="973" y="992.2402">...</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="457" x="750.5" y="1025.0703"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="773.5" y="1046.209">Generate for</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="857.5" y="1046.209">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="113" x="1071.5" y="1046.209">from the values of</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="760.5" y="1060.1777">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="885.5" y="1060.1777">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="102" x="905.5" y="1060.1777">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="1007.5" y="1060.1777">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1041.5" y="1060.1777">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="15" x="1178.5" y="1060.1777">.Id</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="49" x="765.5" y="1074.1465">and the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="818.5" y="1074.1465">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="943.5" y="1074.1465">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="102" x="963.5" y="1074.1465">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="1065.5" y="1074.1465">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1099.5" y="1074.1465">PresciptionId</text><rect fill="#F1F1F1" height="169.6875" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="565" x="696.5" y="1106.9766"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="90" x="934" y="1128.1152">&lt;&lt; Create &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="137" x="910.5" y="1142.084">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="754" y="1156.0527">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="125" x="786" y="1156.0527">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="20" x="911" y="1156.0527">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="102" x="931" y="1156.0527">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1033" y="1156.0527">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1067" y="1156.0527">MedicationRequest</text><line style="stroke:#181818;stroke-width:1.0;" x1="696.5" x2="1261.5" y1="1163.8828" y2="1163.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="696.5" x2="1261.5" y1="1165.8828" y2="1165.8828"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="706.5" y="1180.0215">identifier[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="766.5" y="1180.0215">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="262" x="989.5" y="1180.0215">] = Value(RxPrescriptionProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="719.5" y="1193.9902">identifier[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="779.5" y="1193.9902">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="249" x="989.5" y="1193.9902">] = Value(RxOriginatorProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="933" y="1207.959">status=</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="42" x="983" y="1207.959">active</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="47" x="917.5" y="1221.9277">intent=</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="76" x="964.5" y="1221.9277">filler-order</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="56" x="896" y="1235.8965">subject=</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="952" y="1235.8965">IdentifierKvid10</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="220" x="827.5" y="1249.8652">medicationReference = Reference(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1047.5" y="1249.8652">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1125.5" y="1249.8652">)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="149" x="844.5" y="1263.834">requester = Reference(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="115" x="993.5" y="1263.834">PractitionerRole</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1108.5" y="1263.834">)</text><rect fill="#98FB98" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="513" x="722.5" y="1296.6641"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99" x="732.5" y="1317.8027">Add information</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="135" x="835.5" y="1317.8027">OperationOutcome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="109" x="974.5" y="1317.8027">(SUCCESS) to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="1087.5" y="1317.8027">Output-Parameters</text><polygon fill="#F1F1F1" points="630.25,1348.6328,642.25,1360.6328,630.25,1372.6328,618.25,1360.6328,630.25,1348.6328" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="552" x="1416" y="229.2344"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="1426" y="250.373">Add error</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="135" x="1489" y="250.373">OperationOutcome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="188" x="1628" y="250.373">(NO_VALID_STRUCTURE) to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="1820" y="250.373">Output-Parameters</text><polygon fill="#F1F1F1" points="1161.125,1378.6328,1173.125,1390.6328,1161.125,1402.6328,1149.125,1390.6328,1161.125,1378.6328" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="365" x="978.625" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="988.625" y="108.4355">Get next</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="102" x="1045.625" y="108.4355">RxPrescription</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="1151.625" y="108.4355">from the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1208.625" y="108.4355">Input-Parameters</text><polygon fill="#F1F1F1" points="1067.125,1422.6328,1255.125,1422.6328,1267.125,1434.6328,1255.125,1446.6328,1067.125,1446.6328,1055.125,1434.6328,1067.125,1422.6328" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1165.125" y="1456.8433">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="1067.125" y="1438.4409">If next</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="111" x="1106.125" y="1438.4409">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="1221.125" y="1438.4409">exists</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1267.125" y="1432.0386">yes</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="214" x="1054.125" y="1478.3433"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="51" x="1064.125" y="1499.4819">Return "</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="1115.125" y="1499.4819">Output-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1253.125" y="1499.4819">"</text><ellipse cx="1161.125" cy="1543.312" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="1161.125" cy="1543.312" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="979" y1="495.6953" y2="515.6953"/><polygon fill="#181818" points="975,505.6953,979,515.6953,983,505.6953,979,509.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="979" y1="615.5391" y2="635.5391"/><polygon fill="#181818" points="975,625.5391,979,635.5391,983,625.5391,979,629.5391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="979" y1="721.4141" y2="741.4141"/><polygon fill="#181818" points="975,731.4141,979,741.4141,983,731.4141,979,735.4141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="979" y1="789.3516" y2="809.3516"/><polygon fill="#181818" points="975,799.3516,979,809.3516,983,799.3516,979,803.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="979" y1="843.3203" y2="863.3203"/><polygon fill="#181818" points="975,853.3203,979,863.3203,983,853.3203,979,857.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="979" y1="1005.0703" y2="1025.0703"/><polygon fill="#181818" points="975,1015.0703,979,1025.0703,983,1015.0703,979,1019.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="979" y1="1086.9766" y2="1106.9766"/><polygon fill="#181818" points="975,1096.9766,979,1106.9766,983,1096.9766,979,1100.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="979" y1="1276.6641" y2="1296.6641"/><polygon fill="#181818" points="975,1286.6641,979,1296.6641,983,1286.6641,979,1290.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="373.75" x2="281.5" y1="330.3477" y2="330.3477"/><line style="stroke:#181818;stroke-width:1.0;" x1="281.5" x2="281.5" y1="330.3477" y2="359.5547"/><polygon fill="#181818" points="277.5,349.5547,281.5,359.5547,285.5,349.5547,281.5,353.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="886.75" x2="979" y1="330.3477" y2="330.3477"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="979" y1="330.3477" y2="395.8516"/><polygon fill="#181818" points="975,385.8516,979,395.8516,983,385.8516,979,389.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="281.5" x2="281.5" y1="393.5234" y2="1360.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="281.5" x2="618.25" y1="1360.6328" y2="1360.6328"/><polygon fill="#181818" points="608.25,1356.6328,618.25,1360.6328,608.25,1364.6328,612.25,1360.6328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="979" y1="1330.6328" y2="1360.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="642.25" y1="1360.6328" y2="1360.6328"/><polygon fill="#181818" points="652.25,1356.6328,642.25,1360.6328,652.25,1364.6328,648.25,1360.6328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="630.25" x2="630.25" y1="291.1406" y2="311.1406"/><polygon fill="#181818" points="626.25,301.1406,630.25,311.1406,634.25,301.1406,630.25,305.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1087.625" x2="630.25" y1="207.2344" y2="207.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="630.25" x2="630.25" y1="207.2344" y2="229.2344"/><polygon fill="#181818" points="626.25,219.2344,630.25,229.2344,634.25,219.2344,630.25,223.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1234.625" x2="1692" y1="207.2344" y2="207.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1692" x2="1692" y1="207.2344" y2="229.2344"/><polygon fill="#181818" points="1688,219.2344,1692,229.2344,1696,219.2344,1692,223.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="630.25" x2="630.25" y1="1372.6328" y2="1390.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="630.25" x2="1149.125" y1="1390.6328" y2="1390.6328"/><polygon fill="#181818" points="1139.125,1386.6328,1149.125,1390.6328,1139.125,1394.6328,1143.125,1390.6328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1692" x2="1692" y1="263.2031" y2="1390.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="1692" x2="1173.125" y1="1390.6328" y2="1390.6328"/><polygon fill="#181818" points="1183.125,1386.6328,1173.125,1390.6328,1183.125,1394.6328,1179.125,1390.6328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1161.125" x2="1161.125" y1="175.2344" y2="195.2344"/><polygon fill="#181818" points="1157.125,185.2344,1161.125,195.2344,1165.125,185.2344,1161.125,189.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1161.125" x2="1161.125" y1="121.2656" y2="141.2656"/><polygon fill="#181818" points="1157.125,131.2656,1161.125,141.2656,1165.125,131.2656,1161.125,135.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1267.125" x2="1982" y1="1434.6328" y2="1434.6328"/><polygon fill="#181818" points="1978,783.457,1982,773.457,1986,783.457,1982,779.457" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1982" x2="1982" y1="104.2813" y2="1434.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="1982" x2="1343.625" y1="104.2813" y2="104.2813"/><polygon fill="#181818" points="1353.625,100.2813,1343.625,104.2813,1353.625,108.2813,1349.625,104.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1161.125" x2="1161.125" y1="1402.6328" y2="1422.6328"/><polygon fill="#181818" points="1157.125,1412.6328,1161.125,1422.6328,1165.125,1412.6328,1161.125,1416.6328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1161.125" x2="1161.125" y1="67.2969" y2="87.2969"/><polygon fill="#181818" points="1157.125,77.2969,1161.125,87.2969,1165.125,77.2969,1161.125,81.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1161.125" x2="1161.125" y1="1446.6328" y2="1478.3433"/><polygon fill="#181818" points="1157.125,1468.3433,1161.125,1478.3433,1165.125,1468.3433,1161.125,1472.3433" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1161.125" x2="1161.125" y1="1512.312" y2="1532.312"/><polygon fill="#181818" points="1157.125,1522.312,1161.125,1532.312,1165.125,1522.312,1161.125,1526.312" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[8bb833772fd08c6e7bc02e61dbce4847]
@startuml operation.provide-prescription-erp
skinparam defaultTextAlignment center
skinparam title {
  backgroundColor SkyBlue
  borderColor Gray
} 
title $provide-prescription-erp
start


repeat:Get next <b>RxPrescription</b> from the <b>Input-Parameters</b>;

:Validate <b>MedicationRequest</b>, <b>Medication</b>, <b>Organization</b> and <b>Practitioner</b> from <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part;

if (Validation successfull) then (yes)
  
  :Generate <b>RxPrescriptionProcessIdentifier</b> from the values of \n <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part.<b>authoredOn</b> and the \n <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part.<b>PresciptionId</b>;;

  if(Check if there is a <b>MedicationRequest</b> with the <b>RxPrescriptionProcessIdentifier</b> \n and \n the status <b>active</b> or <b>completed</b> already in the Medication Service) then (yes)
    
    #Pink:Add error <b>OperationOutcome</b> (NO_EXIST or STATUS) to the <b>Output-Parameters</b>; 
  
  else (no)

    partition transaction {
        
      :<< Create or Update >> 
      <b>Organization</b>
      <i>from <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part.<b>Organization</b></i>
      ====
      identifier[TelematikID] = TelematikID
      ...;
        
      :<< Create or Update >> 
      <b>Practitioner</b>
      <i>from <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part.<b>Practitioner</b></i>
      ====
      identifier[TelematikID] = TelematikID
      ...;
        
      :<< Create or Update >> 
      <b>PractitionerRole</b>
      ====
      practitioner = Reference(<b>Practitioner</b>)
      organization = Reference(<b>Organization</b>);

      :Generate for <b>RxOriginatorProcessIdentifier</b> from the values of 
      <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part.<b>Medication</b>.Id and the Input-<b>PresciptionId</b>;

      :Generate for <b>EPAMedicationUniqueIdentifier</b> from the hashed <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part.<b>Medication</b>;
        
      :<< Create >>
      <b>Medication</b>
      <i>from <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part.<b>Medication</b></i>
      ====
      identifier[<b>EPAMedicationUniqueIdentifier</b>] = Value(EPAMedicationUniqueIdentifier)
      identifier[<b>RxOriginatorProcessIdentifier</b>] = Value(RxOriginatorProcessIdentifier)
      extension[<b>RxPrescriptionProcessIdentifier</b>] = Value(RxPrescriptionProcessIdentifier)
      status = <b>inactive</b>
      ...;
        
      :Generate for <b>RxOriginatorProcessIdentifier</b> from the values of 
      <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part.<b>MedicationRequest</b>.Id 
      and the <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part.<b>PresciptionId</b>;

      :<< Create >>
      <b>MedicationRequest</b>
      <i>from <b>Input-Parameters</b>[x].<b>RxPrescription</b>.part.<b>MedicationRequest</b></i>
      ====
      identifier[<b>RxPrescriptionProcessIdentifier</b>] = Value(RxPrescriptionProcessIdentifier)
      identifier[<b>RxOriginatorProcessIdentifier</b>] = Value(RxOriginatorProcessIdentifier)
      status=<b>active</b>
      intent=<b>filler-order</b>
      subject=<b>IdentifierKvid10</b>
      medicationReference = Reference(<b>Medication</b>)
      requester = Reference(<b>PractitionerRole</b>);

      #PaleGreen:Add information <b>OperationOutcome</b> (SUCCESS) to the <b>Output-Parameters</b>;
    }

  endif

else (no)
  #Pink:Add error <b>OperationOutcome</b> (NO_VALID_STRUCTURE) to the <b>Output-Parameters</b>;
endif

repeat while (If next <b>Input-Parameters</b> exists) is (yes) not (no)
  
:Return "<b>Output-Parameters</b>";
stop  
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>