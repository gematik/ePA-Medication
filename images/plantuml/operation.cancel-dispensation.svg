<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="613px" preserveAspectRatio="none" style="width:1050px;height:613px;background:#FFFFFF;" version="1.1" viewBox="0 0 1050 613" width="1050px" zoomAndPan="magnify"><defs/><g><rect fill="#87CEEB" height="26.2969" id="_title" style="stroke:#808080;stroke-width:1.0;" width="178" x="434.75" y="15"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="168" x="439.75" y="32.9951">$cancel-dispensation</text><ellipse cx="596.5" cy="57.2969" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="none" height="428.9844" style="stroke:#000000;stroke-width:1.5;" width="1028.5" x="11" y="77.2969"/><path d="M98,77.2969 L98,86.5938 L88,96.5938 L11,96.5938 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="14" y="91.292">transaction</text><polygon fill="#F1F1F1" points="329,167.5625,864,167.5625,876,179.5625,864,191.5625,329,191.5625,317,179.5625,329,167.5625" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="7" x="329" y="183.3706">If</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130" x="340" y="183.3706">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="23" x="474" y="183.3706">with</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="201" x="501" y="183.3706">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="158" x="706" y="183.3706">exists in Medication Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="297" y="176.9683">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="876" y="176.9683">no</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="568" x="23" y="201.5625"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39" x="186.5" y="222.7012">Set all</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="229.5" y="222.7012">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="377.5" y="222.7012">with the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="321" x="33" y="236.6699">extension[RxPrescriptionProcessIdentifier] equal to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="358" y="236.6699">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="242.5" y="250.6387">to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="67" x="304.5" y="250.6387">cancelled</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="568" x="23" y="298.4688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39" x="219.5" y="319.6074">Set all</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="262.5" y="319.6074">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="344.5" y="319.6074">with the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="321" x="33" y="333.5762">extension[RxPrescriptionProcessIdentifier] equal to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="358" y="333.5762">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="248.5" y="347.5449">to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="55" x="310.5" y="347.5449">inactive</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="568" x="23" y="380.375"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="21" x="199" y="401.5137">Set</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="137" x="224" y="401.5137">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="365" y="401.5137">with the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="321" x="33" y="415.4824">extension[RxPrescriptionProcessIdentifier] equal to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="358" y="415.4824">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="255" y="429.4512">to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="42" x="317" y="429.4512">active</text><rect fill="#FFC0CB" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="247" x="762.5" y="201.5625"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="227" x="772.5" y="222.7012">Return "OperationOutcome (failure)"</text><ellipse cx="886" cy="280.5313" fill="none" rx="10" ry="10" style="stroke:#222222;stroke-width:1.5;"/><line style="stroke:#222222;stroke-width:2.5;" x1="879.8128" x2="892.1872" y1="274.3441" y2="286.7184"/><line style="stroke:#222222;stroke-width:2.5;" x1="892.1872" x2="879.8128" y1="274.3441" y2="286.7184"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="300" x="446.5" y="113.5938"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="456.5" y="134.7324">Get next</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="513.5" y="134.7324">RxPrescriptionProcessIdentifier</text><polygon fill="#F1F1F1" points="457.5,462.2813,735.5,462.2813,747.5,474.2813,735.5,486.2813,457.5,486.2813,445.5,474.2813,457.5,462.2813" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="600.5" y="496.4917">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="457.5" y="478.0894">If next</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="201" x="496.5" y="478.0894">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="701.5" y="478.0894">exists</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="747.5" y="471.687">yes</text><rect fill="#98FB98" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="259" x="467" y="526.2813"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="239" x="477" y="547.4199">Return "OperationOutcome (success)"</text><ellipse cx="596.5" cy="591.25" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="596.5" cy="591.25" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="307" y1="263.4688" y2="298.4688"/><polygon fill="#181818" points="303,288.4688,307,298.4688,311,288.4688,307,292.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="307" y1="360.375" y2="380.375"/><polygon fill="#181818" points="303,370.375,307,380.375,311,370.375,307,374.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="886" x2="886" y1="235.5313" y2="270.5313"/><polygon fill="#181818" points="882,260.5313,886,270.5313,890,260.5313,886,264.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="317" x2="307" y1="179.5625" y2="179.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="307" y1="179.5625" y2="201.5625"/><polygon fill="#181818" points="303,191.5625,307,201.5625,311,191.5625,307,195.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="876" x2="886" y1="179.5625" y2="179.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="886" x2="886" y1="179.5625" y2="201.5625"/><polygon fill="#181818" points="882,191.5625,886,201.5625,890,191.5625,886,195.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="307" y1="442.2813" y2="447.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="596.5" y1="447.2813" y2="447.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="596.5" x2="596.5" y1="447.2813" y2="462.2813"/><polygon fill="#181818" points="592.5,452.2813,596.5,462.2813,600.5,452.2813,596.5,456.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="596.5" x2="596.5" y1="147.5625" y2="167.5625"/><polygon fill="#181818" points="592.5,157.5625,596.5,167.5625,600.5,157.5625,596.5,161.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="747.5" x2="1023.5" y1="474.2813" y2="474.2813"/><polygon fill="#181818" points="1019.5,322.9297,1023.5,312.9297,1027.5,322.9297,1023.5,318.9297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1023.5" x2="1023.5" y1="130.5781" y2="474.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="1023.5" x2="746.5" y1="130.5781" y2="130.5781"/><polygon fill="#181818" points="756.5,126.5781,746.5,130.5781,756.5,134.5781,752.5,130.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="596.5" x2="596.5" y1="67.2969" y2="113.5938"/><polygon fill="#181818" points="592.5,103.5938,596.5,113.5938,600.5,103.5938,596.5,107.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="596.5" x2="596.5" y1="486.2813" y2="526.2813"/><polygon fill="#181818" points="592.5,516.2813,596.5,526.2813,600.5,516.2813,596.5,520.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="596.5" x2="596.5" y1="560.25" y2="580.25"/><polygon fill="#181818" points="592.5,570.25,596.5,580.25,600.5,570.25,596.5,574.25" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[b73ede69adf60694ff79585fcc9d11fd]
@startuml operation.cancel-dispensation
skinparam defaultTextAlignment center
skinparam title {
  backgroundColor SkyBlue
  borderColor Gray
} 
title $cancel-dispensation

start
partition transaction {

  repeat:Get next <b>RxPrescriptionProcessIdentifier</b>;

    if(If <b>MedicationDispense</b> with <b>RxPrescriptionProcessIdentifier</b> exists in Medication Service) then (yes)

      :Set all <b>MedicationDispense</b> with the 
      extension[RxPrescriptionProcessIdentifier] equal to <b>RxPrescriptionProcessIdentifier</b>
      to Status <b>cancelled</b>;

      :Set all <b>Medication</b> with the 
      extension[RxPrescriptionProcessIdentifier] equal to <b>RxPrescriptionProcessIdentifier</b>
      to Status <b>inactive</b>;

      :Set <b>MedicationRequest</b> with the 
      extension[RxPrescriptionProcessIdentifier] equal to <b>RxPrescriptionProcessIdentifier</b>
      to Status <b>active</b>;

    else (no)

      #Pink:Return "OperationOutcome (failure)";
      end

    endif

  repeat while (If next <b>RxPrescriptionProcessIdentifier</b> exists) is (yes) not (no)

}

#palegreen:Return "OperationOutcome (success)";
stop
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>