<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2073px" preserveAspectRatio="none" style="width:2802px;height:2073px;background:#FFFFFF;" version="1.1" viewBox="0 0 2802 2073" width="2802px" zoomAndPan="magnify"><defs/><g><rect fill="#87CEEB" height="26.2969" id="_title" style="stroke:#808080;stroke-width:1.0;" width="220" x="1289.5" y="15"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1294.5" y="32.9951">$provide-dispensation-erp</text><ellipse cx="1688.9375" cy="57.2969" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="769" x="1304.4375" y="141.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="69" x="1314.4375" y="162.4043">Validate all</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1387.4375" y="162.4043">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1465.4375" y="162.4043">,</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1473.4375" y="162.4043">Organization</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="1570.4375" y="162.4043">and</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1598.4375" y="162.4043">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="28" x="1746.4375" y="162.4043">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1778.4375" y="162.4043">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="1903.4375" y="162.4043">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1923.4375" y="162.4043">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="30" x="2033.4375" y="162.4043">.part</text><polygon fill="#F1F1F1" points="1627.4375,195.2344,1750.4375,195.2344,1762.4375,214.4414,1750.4375,233.6484,1627.4375,233.6484,1615.4375,214.4414,1627.4375,195.2344" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1686.9375" y="205.4448"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="1627.4375" y="218.2495">Validation successfull</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1686.9375" y="231.0542"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1595.4375" y="211.8472">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1762.4375" y="211.8472">no</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="452" x="631.875" y="243.6484"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="656.375" y="264.7871">Generate</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="719.375" y="264.7871">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="113" x="946.375" y="264.7871">from the values of</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="641.875" y="278.7559">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="766.875" y="278.7559">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="786.875" y="278.7559">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="896.875" y="278.7559">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="86" x="930.875" y="278.7559">authoredOn</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="49" x="1020.875" y="278.7559">and the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="663.875" y="292.7246">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="788.875" y="292.7246">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="808.875" y="292.7246">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="918.875" y="292.7246">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="99" x="952.875" y="292.7246">PrescriptionId</text><polygon fill="#F1F1F1" points="613.375,325.5547,1102.375,325.5547,1114.375,357.5664,1102.375,389.5781,613.375,389.5781,601.375,357.5664,613.375,325.5547" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="855.875" y="335.7651"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="613.375" y="348.5698">Check if there is a</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123" x="721.375" y="348.5698">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="45" x="848.375" y="348.5698">with the</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="201" x="897.375" y="348.5698">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1098.375" y="348.5698"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="847.375" y="361.3745">and</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="86" x="689.375" y="374.1792">the status NOT</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="67" x="779.375" y="374.1792">completed</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="180" x="850.375" y="374.1792">exists in the Medication Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="855.875" y="386.9839"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="587.375" y="354.9722">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1114.375" y="354.9722">yes</text><rect fill="#FFC0CB" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="490" x="11" y="399.5781"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="21" y="420.7168">Add error</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="135" x="84" y="420.7168">OperationOutcome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="264" x="223" y="420.7168">(MEDICATIONSVC_PRESCRIPTION_NO_EXIST)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="313" x="28.5" y="434.6855">or (MEDICATIONSVC_PRESCRIPTION_STATUS) to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="345.5" y="434.6855">Output-Parameters</text><rect fill="none" height="1451.7305" style="stroke:#000000;stroke-width:1.5;" width="1689" x="511" y="399.5781"/><path d="M598,399.5781 L598,408.875 L588,418.875 L511,418.875 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="514" y="413.5732">transaction</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="572" x="1201.75" y="435.875"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39" x="1367.25" y="457.0137">Set all</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1410.25" y="457.0137">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="1558.25" y="457.0137">with the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="321" x="1211.75" y="470.9824">extension[RxPrescriptionProcessIdentifier] equal to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="1536.75" y="470.9824">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1759.75" y="470.9824"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="219" x="1346.25" y="484.9512">in the Medication Service to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="60" x="1569.25" y="484.9512">declined</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="568" x="1203.75" y="517.7813"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39" x="1400.25" y="538.9199">Set all</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1443.25" y="538.9199">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="1525.25" y="538.9199">with the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="321" x="1213.75" y="552.8887">extension[RxPrescriptionProcessIdentifier] equal to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="1538.75" y="552.8887">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="1429.25" y="566.8574">to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="55" x="1491.25" y="566.8574">inactive</text><rect fill="#F1F1F1" height="99.8438" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="434" x="1270.75" y="599.6875"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="157" x="1409.25" y="620.8262">&lt;&lt; Create or Update &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1441.25" y="634.7949">Organization</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="1280.75" y="648.7637">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1312.75" y="648.7637">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="20" x="1437.75" y="648.7637">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1457.75" y="648.7637">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1567.75" y="648.7637">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1601.75" y="648.7637">Organization</text><line style="stroke:#181818;stroke-width:1.0;" x1="1270.75" x2="1704.75" y1="656.5938" y2="656.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1270.75" x2="1704.75" y1="658.5938" y2="658.5938"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="272" x="1351.75" y="672.7324">identifier[TelematikID] = Value(TelematikID)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="1481.75" y="686.7012">...</text><rect fill="none" height="1007.8711" style="stroke:#000000;stroke-width:1.5;" width="1669" x="521" y="709.5313"/><path d="M561,709.5313 L561,718.8281 L551,728.8281 L521,728.8281 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="524" y="723.5264">loop</text><polygon fill="#F1F1F1" points="1309.25,799.7969,1666.25,799.7969,1678.25,844.6133,1666.25,889.4297,1309.25,889.4297,1297.25,844.6133,1309.25,799.7969" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1485.75" y="810.0073"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="67" x="1358.75" y="822.812">Check if the</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130" x="1429.75" y="822.812">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="49" x="1563.75" y="822.812">from the</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1309.25" y="835.6167"> </text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="111" x="1313.25" y="835.6167">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="18" x="1424.25" y="835.6167">[x].</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99" x="1442.25" y="835.6167">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="121" x="1541.25" y="835.6167">.part in medication[x]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="39" x="1366.25" y="848.4214">uses a</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="196" x="1409.25" y="848.4214">Data Absent Reason Extension</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1605.25" y="848.4214">.</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="127" x="1330.25" y="861.2261">This indicates that the</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130" x="1461.25" y="861.2261">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="50" x="1595.25" y="861.2261">does not</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="79" x="1412.75" y="874.0308">reference any</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="71" x="1495.75" y="874.0308">Medication</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1485.75" y="886.8354"> </text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="56" x="1030.25" y="842.019">NOT USE</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="7" x="1090.25" y="842.019">a</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="196" x="1101.25" y="842.019">Data Absent Reason Extension</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="25" x="1678.25" y="842.019">USE</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="7" x="1707.25" y="842.019">a</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="196" x="1718.25" y="842.019">Data Absent Reason Extension</text><rect fill="#F1F1F1" height="75.875" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="477" x="820" y="899.4297"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1056.5" y="920.5684"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="47" x="830" y="934.5371">Get the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="881" y="934.5371">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="172" x="963" y="934.5371">resource referenced by the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1139" y="934.5371">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1283" y="934.5371"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="889.5" y="948.5059">from the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="946.5" y="948.5059">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="1071.5" y="948.5059">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1091.5" y="948.5059">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="30" x="1201.5" y="948.5059">.part</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1056.5" y="962.4746"> </text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="549" x="784" y="995.3047"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="794" y="1016.4434">Generate for</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="219" x="878" y="1016.4434">EPAMedicationUniqueIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="144" x="1101" y="1016.4434">from the hashed Input-</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1245" y="1016.4434">Medication</text><polygon fill="#F1F1F1" points="792,1051.6211,1325,1051.6211,1337,1083.6328,1325,1115.6445,792,1115.6445,780,1083.6328,792,1051.6211" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1056.5" y="1061.8315"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="141" x="792" y="1074.6362">Verify whether there is a</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="71" x="937" y="1074.6362">Medication</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="45" x="1012" y="1074.6362">with the</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="201" x="1061" y="1074.6362">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="55" x="1266" y="1074.6362">extension</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="1048" y="1087.4409">and</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="154" x="809" y="1100.2456">the generated hash for the</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="199" x="967" y="1100.2456">EPAMedicationUniqueIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="1170" y="1100.2456">in the Medication Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1056.5" y="1113.0503"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="760" y="1081.0386">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1337" y="1081.0386">no</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="474" x="533" y="1125.6445"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="46" x="543" y="1146.7832">Update</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="593" y="1146.7832">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="25" x="675" y="1146.7832">with</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="704" y="1146.7832">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="66" x="931" y="1146.7832">extenstion</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="592.5" y="1160.752">and</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="219" x="620.5" y="1160.752">EPAMedicationUniqueIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="843.5" y="1160.752">to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="42" x="905.5" y="1160.752">active</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="594" x="1050" y="1125.6445"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="1141.5" y="1146.7832">Generate for</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1225.5" y="1146.7832">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="113" x="1439.5" y="1146.7832">from the values of</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1060" y="1160.752">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="1185" y="1160.752">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1205" y="1160.752">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="1315" y="1160.752">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1349" y="1160.752">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="108" x="1427" y="1160.752">.Id and the Input-</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="99" x="1535" y="1160.752">PrescriptionId</text><rect fill="#F1F1F1" height="141.75" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="571" x="1061.5" y="1193.582"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="90" x="1302" y="1214.7207">&lt;&lt; Create &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1308" y="1228.6895">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="1147.5" y="1242.6582">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1179.5" y="1242.6582">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="20" x="1304.5" y="1242.6582">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1324.5" y="1242.6582">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1434.5" y="1242.6582">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1468.5" y="1242.6582">Medication</text><line style="stroke:#181818;stroke-width:1.0;" x1="1061.5" x2="1632.5" y1="1250.4883" y2="1250.4883"/><line style="stroke:#181818;stroke-width:1.0;" x1="1061.5" x2="1632.5" y1="1252.4883" y2="1252.4883"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="1078" y="1266.627">identifier[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="219" x="1138" y="1266.627">EPAMedicationUniqueIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="259" x="1357" y="1266.627">] = Value(EPAMedicationUniqueIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="1087.5" y="1280.5957">identifier[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1147.5" y="1280.5957">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="249" x="1357.5" y="1280.5957">] = Value(RxOriginatorProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="66" x="1071.5" y="1294.5645">extension[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="1137.5" y="1294.5645">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="262" x="1360.5" y="1294.5645">] = Value(RxPrescriptionProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="54" x="1297" y="1308.5332">status =</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="42" x="1355" y="1308.5332">active</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="1341" y="1322.502">...</text><polygon fill="#F1F1F1" points="1058.5,1341.332,1070.5,1353.332,1058.5,1365.332,1046.5,1353.332,1058.5,1341.332" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="486" x="1674" y="899.4297"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="65" x="1684" y="920.5684">Use of the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1753" y="920.5684">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="170" x="1835" y="920.5684">instance referenced by the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="137" x="2009" y="920.5684">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="2146" y="920.5684"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="108" x="1751.5" y="934.5371">instance with the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="1863.5" y="934.5371">RxPrescriptionProcessIdentifier</text><polygon fill="#F1F1F1" points="1487.75,1371.332,1499.75,1383.332,1487.75,1395.332,1475.75,1383.332,1487.75,1371.332" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="660" x="1157.75" y="1415.332"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="1282.25" y="1436.4707">Generate for</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1366.25" y="1436.4707">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="113" x="1580.25" y="1436.4707">from the values of</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1167.75" y="1450.4395">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="1292.75" y="1450.4395">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1312.75" y="1450.4395">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="1422.75" y="1450.4395">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1456.75" y="1450.4395">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="108" x="1600.75" y="1450.4395">.Id and the Input-</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="99" x="1708.75" y="1450.4395">PrescriptionId</text><rect fill="#F1F1F1" height="155.7188" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="571" x="1202.25" y="1483.2695"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="90" x="1442.75" y="1504.4082">&lt;&lt; Create &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1415.75" y="1518.377">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="1255.25" y="1532.3457">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1287.25" y="1532.3457">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="20" x="1412.25" y="1532.3457">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1432.25" y="1532.3457">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1542.25" y="1532.3457">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1576.25" y="1532.3457">MedicationDispense</text><line style="stroke:#181818;stroke-width:1.0;" x1="1202.25" x2="1773.25" y1="1540.1758" y2="1540.1758"/><line style="stroke:#181818;stroke-width:1.0;" x1="1202.25" x2="1773.25" y1="1542.1758" y2="1542.1758"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="1228.25" y="1556.3145">identifier[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1288.25" y="1556.3145">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="249" x="1498.25" y="1556.3145">] = Value(RxOriginatorProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="66" x="1212.25" y="1570.2832">extension[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="1278.25" y="1570.2832">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="262" x="1501.25" y="1570.2832">] = Value(RxPrescriptionProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="220" x="1336.25" y="1584.252">medicationReference = Reference(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1556.25" y="1584.252">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1634.25" y="1584.252">)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="186" x="1345.75" y="1598.2207">performer.actor = Reference(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1531.75" y="1598.2207">Organization</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1624.75" y="1598.2207">)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="231" x="1301.25" y="1612.1895">authorizingPrescription = Reference(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1532.25" y="1612.1895">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1669.25" y="1612.1895">)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="54" x="1421.75" y="1626.1582">status =</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="74" x="1479.75" y="1626.1582">completed</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="627" x="1174.25" y="745.8281"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="1188.25" y="766.9668">Get next</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1245.25" y="766.9668">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="103" x="1393.25" y="766.9668">from the current</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1500.25" y="766.9668">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1610.25" y="766.9668"> </text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1614.25" y="766.9668">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="48" x="1743.25" y="766.9668">part list</text><polygon fill="#F1F1F1" points="1244.25,1658.9883,1731.25,1658.9883,1743.25,1678.1953,1731.25,1697.4023,1244.25,1697.4023,1232.25,1678.1953,1244.25,1658.9883" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1491.75" y="1707.6128">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1727.25" y="1669.1987"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="1244.25" y="1682.0034">If next</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130" x="1283.25" y="1682.0034">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="10" x="1417.25" y="1682.0034">in</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="111" x="1431.25" y="1682.0034">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1542.25" y="1682.0034"> </text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99" x="1546.25" y="1682.0034">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="82" x="1649.25" y="1682.0034">part list exists</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1727.25" y="1694.8081"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1743.25" y="1675.6011">yes</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="438" x="1268.75" y="1737.4023"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="21" x="1278.75" y="1758.541">Set</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1303.75" y="1758.541">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="25" x="1444.75" y="1758.541">with</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="1473.75" y="1758.541">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="1419.75" y="1772.5098">to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="74" x="1481.75" y="1772.5098">completed</text><rect fill="#98FB98" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="692" x="1141.75" y="1805.3398"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99" x="1151.75" y="1826.4785">Add information</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="135" x="1254.75" y="1826.4785">OperationOutcome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="288" x="1393.75" y="1826.4785">(MEDICATIONSVC_OPERATION_SUCCESS) to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="1685.75" y="1826.4785">Output-Parameters</text><polygon fill="#F1F1F1" points="857.875,1857.3086,869.875,1869.3086,857.875,1881.3086,845.875,1869.3086,857.875,1857.3086" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="552" x="2210" y="243.6484"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="2220" y="264.7871">Add error</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="135" x="2283" y="264.7871">OperationOutcome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="188" x="2422" y="264.7871">(NO_VALID_STRUCTURE) to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="2614" y="264.7871">Output-Parameters</text><polygon fill="#F1F1F1" points="1688.9375,1887.3086,1700.9375,1899.3086,1688.9375,1911.3086,1676.9375,1899.3086,1688.9375,1887.3086" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="373" x="1502.4375" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="1512.4375" y="108.4355">Get next</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1569.4375" y="108.4355">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="1683.4375" y="108.4355">from the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1740.4375" y="108.4355">Input-Parameters</text><polygon fill="#F1F1F1" points="1594.9375,1931.3086,1782.9375,1931.3086,1794.9375,1943.3086,1782.9375,1955.3086,1594.9375,1955.3086,1582.9375,1943.3086,1594.9375,1931.3086" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1692.9375" y="1965.519">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="1594.9375" y="1947.1167">If next</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="111" x="1633.9375" y="1947.1167">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="1748.9375" y="1947.1167">exists</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1794.9375" y="1940.7144">yes</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="214" x="1581.9375" y="1987.019"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="51" x="1591.9375" y="2008.1577">Return "</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="1642.9375" y="2008.1577">Output-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1780.9375" y="2008.1577">"</text><ellipse cx="1688.9375" cy="2051.9878" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="1688.9375" cy="2051.9878" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="497.7813" y2="517.7813"/><polygon fill="#181818" points="1483.75,507.7813,1487.75,517.7813,1491.75,507.7813,1487.75,511.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="579.6875" y2="599.6875"/><polygon fill="#181818" points="1483.75,589.6875,1487.75,599.6875,1491.75,589.6875,1487.75,593.6875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1058.5" x2="1058.5" y1="975.3047" y2="995.3047"/><polygon fill="#181818" points="1054.5,985.3047,1058.5,995.3047,1062.5,985.3047,1058.5,989.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1347" x2="1347" y1="1173.582" y2="1193.582"/><polygon fill="#181818" points="1343,1183.582,1347,1193.582,1351,1183.582,1347,1187.582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="780" x2="770" y1="1083.6328" y2="1083.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="770" x2="770" y1="1083.6328" y2="1125.6445"/><polygon fill="#181818" points="766,1115.6445,770,1125.6445,774,1115.6445,770,1119.6445" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1337" x2="1347" y1="1083.6328" y2="1083.6328"/><line style="stroke:#181818;stroke-width:1.0;" x1="1347" x2="1347" y1="1083.6328" y2="1125.6445"/><polygon fill="#181818" points="1343,1115.6445,1347,1125.6445,1351,1115.6445,1347,1119.6445" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="770" x2="770" y1="1173.582" y2="1353.332"/><line style="stroke:#181818;stroke-width:1.0;" x1="770" x2="1046.5" y1="1353.332" y2="1353.332"/><polygon fill="#181818" points="1036.5,1349.332,1046.5,1353.332,1036.5,1357.332,1040.5,1353.332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1347" x2="1347" y1="1335.332" y2="1353.332"/><line style="stroke:#181818;stroke-width:1.0;" x1="1347" x2="1070.5" y1="1353.332" y2="1353.332"/><polygon fill="#181818" points="1080.5,1349.332,1070.5,1353.332,1080.5,1357.332,1076.5,1353.332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1058.5" x2="1058.5" y1="1029.2734" y2="1051.6211"/><polygon fill="#181818" points="1054.5,1041.6211,1058.5,1051.6211,1062.5,1041.6211,1058.5,1045.6211" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1297.25" x2="1058.5" y1="844.6133" y2="844.6133"/><line style="stroke:#181818;stroke-width:1.0;" x1="1058.5" x2="1058.5" y1="844.6133" y2="899.4297"/><polygon fill="#181818" points="1054.5,889.4297,1058.5,899.4297,1062.5,889.4297,1058.5,893.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1678.25" x2="1917" y1="844.6133" y2="844.6133"/><line style="stroke:#181818;stroke-width:1.0;" x1="1917" x2="1917" y1="844.6133" y2="899.4297"/><polygon fill="#181818" points="1913,889.4297,1917,899.4297,1921,889.4297,1917,893.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1058.5" x2="1058.5" y1="1365.332" y2="1383.332"/><line style="stroke:#181818;stroke-width:1.0;" x1="1058.5" x2="1475.75" y1="1383.332" y2="1383.332"/><polygon fill="#181818" points="1465.75,1379.332,1475.75,1383.332,1465.75,1387.332,1469.75,1383.332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1917" x2="1917" y1="947.3672" y2="1383.332"/><line style="stroke:#181818;stroke-width:1.0;" x1="1917" x2="1499.75" y1="1383.332" y2="1383.332"/><polygon fill="#181818" points="1509.75,1379.332,1499.75,1383.332,1509.75,1387.332,1505.75,1383.332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="1395.332" y2="1415.332"/><polygon fill="#181818" points="1483.75,1405.332,1487.75,1415.332,1491.75,1405.332,1487.75,1409.332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="1463.2695" y2="1483.2695"/><polygon fill="#181818" points="1483.75,1473.2695,1487.75,1483.2695,1491.75,1473.2695,1487.75,1477.2695" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="779.7969" y2="799.7969"/><polygon fill="#181818" points="1483.75,789.7969,1487.75,799.7969,1491.75,789.7969,1487.75,793.7969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1743.25" x2="2174" y1="1678.1953" y2="1678.1953"/><polygon fill="#181818" points="2170,1224.1777,2174,1214.1777,2178,1224.1777,2174,1220.1777" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2174" x2="2174" y1="762.8125" y2="1678.1953"/><line style="stroke:#181818;stroke-width:1.0;" x1="2174" x2="1801.25" y1="762.8125" y2="762.8125"/><polygon fill="#181818" points="1811.25,758.8125,1801.25,762.8125,1811.25,766.8125,1807.25,762.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="1638.9883" y2="1658.9883"/><polygon fill="#181818" points="1483.75,1648.9883,1487.75,1658.9883,1491.75,1648.9883,1487.75,1652.9883" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="699.5313" y2="745.8281"/><polygon fill="#181818" points="1483.75,735.8281,1487.75,745.8281,1491.75,735.8281,1487.75,739.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="1697.4023" y2="1737.4023"/><polygon fill="#181818" points="1483.75,1727.4023,1487.75,1737.4023,1491.75,1727.4023,1487.75,1731.4023" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="1785.3398" y2="1805.3398"/><polygon fill="#181818" points="1483.75,1795.3398,1487.75,1805.3398,1491.75,1795.3398,1487.75,1799.3398" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="601.375" x2="256" y1="357.5664" y2="357.5664"/><line style="stroke:#181818;stroke-width:1.0;" x1="256" x2="256" y1="357.5664" y2="399.5781"/><polygon fill="#181818" points="252,389.5781,256,399.5781,260,389.5781,256,393.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1114.375" x2="1487.75" y1="357.5664" y2="357.5664"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="357.5664" y2="435.875"/><polygon fill="#181818" points="1483.75,425.875,1487.75,435.875,1491.75,425.875,1487.75,429.875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="256" x2="256" y1="447.5156" y2="1869.3086"/><line style="stroke:#181818;stroke-width:1.0;" x1="256" x2="845.875" y1="1869.3086" y2="1869.3086"/><polygon fill="#181818" points="835.875,1865.3086,845.875,1869.3086,835.875,1873.3086,839.875,1869.3086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="1487.75" y1="1839.3086" y2="1869.3086"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.75" x2="869.875" y1="1869.3086" y2="1869.3086"/><polygon fill="#181818" points="879.875,1865.3086,869.875,1869.3086,879.875,1873.3086,875.875,1869.3086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="857.875" x2="857.875" y1="305.5547" y2="325.5547"/><polygon fill="#181818" points="853.875,315.5547,857.875,325.5547,861.875,315.5547,857.875,319.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1615.4375" x2="857.875" y1="214.4414" y2="214.4414"/><line style="stroke:#181818;stroke-width:1.0;" x1="857.875" x2="857.875" y1="214.4414" y2="243.6484"/><polygon fill="#181818" points="853.875,233.6484,857.875,243.6484,861.875,233.6484,857.875,237.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1762.4375" x2="2486" y1="214.4414" y2="214.4414"/><line style="stroke:#181818;stroke-width:1.0;" x1="2486" x2="2486" y1="214.4414" y2="243.6484"/><polygon fill="#181818" points="2482,233.6484,2486,243.6484,2490,233.6484,2486,237.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="857.875" x2="857.875" y1="1881.3086" y2="1899.3086"/><line style="stroke:#181818;stroke-width:1.0;" x1="857.875" x2="1676.9375" y1="1899.3086" y2="1899.3086"/><polygon fill="#181818" points="1666.9375,1895.3086,1676.9375,1899.3086,1666.9375,1903.3086,1670.9375,1899.3086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2486" x2="2486" y1="277.6172" y2="1899.3086"/><line style="stroke:#181818;stroke-width:1.0;" x1="2486" x2="1700.9375" y1="1899.3086" y2="1899.3086"/><polygon fill="#181818" points="1710.9375,1895.3086,1700.9375,1899.3086,1710.9375,1903.3086,1706.9375,1899.3086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1688.9375" x2="1688.9375" y1="175.2344" y2="195.2344"/><polygon fill="#181818" points="1684.9375,185.2344,1688.9375,195.2344,1692.9375,185.2344,1688.9375,189.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1688.9375" x2="1688.9375" y1="121.2656" y2="141.2656"/><polygon fill="#181818" points="1684.9375,131.2656,1688.9375,141.2656,1692.9375,131.2656,1688.9375,135.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1794.9375" x2="2776" y1="1943.3086" y2="1943.3086"/><polygon fill="#181818" points="2772,1031.6211,2776,1021.6211,2780,1031.6211,2776,1027.6211" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2776" x2="2776" y1="104.2813" y2="1943.3086"/><line style="stroke:#181818;stroke-width:1.0;" x1="2776" x2="1875.4375" y1="104.2813" y2="104.2813"/><polygon fill="#181818" points="1885.4375,100.2813,1875.4375,104.2813,1885.4375,108.2813,1881.4375,104.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1688.9375" x2="1688.9375" y1="1911.3086" y2="1931.3086"/><polygon fill="#181818" points="1684.9375,1921.3086,1688.9375,1931.3086,1692.9375,1921.3086,1688.9375,1925.3086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1688.9375" x2="1688.9375" y1="67.2969" y2="87.2969"/><polygon fill="#181818" points="1684.9375,77.2969,1688.9375,87.2969,1692.9375,77.2969,1688.9375,81.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1688.9375" x2="1688.9375" y1="1955.3086" y2="1987.019"/><polygon fill="#181818" points="1684.9375,1977.019,1688.9375,1987.019,1692.9375,1977.019,1688.9375,1981.019" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1688.9375" x2="1688.9375" y1="2020.9878" y2="2040.9878"/><polygon fill="#181818" points="1684.9375,2030.9878,1688.9375,2040.9878,1692.9375,2030.9878,1688.9375,2034.9878" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[0e363b16382d2a512b8754b4d2aa9666]
@startuml operation.provide-dispensation-erp
skinparam defaultTextAlignment center
skinparam title {
  backgroundColor SkyBlue
  borderColor Gray
} 
title $provide-dispensation-erp

start

  repeat:Get next <b>RxDispensation</b> from the <b>Input-Parameters</b>;
  
    :Validate all <b>Medication</b>, <b>Organization</b> and <b>MedicationDispense</b> from <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part;

    if (\rValidation successfull\r) then (yes)
      
      :Generate <b>RxPrescriptionProcessIdentifier</b> from the values of 
      <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>authoredOn</b> and the 
      <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>PrescriptionId</b>;


      if(\rCheck if there is a <b>MedicationRequest</b> with the <b>RxPrescriptionProcessIdentifier</b> \n and \n the status NOT <b>completed</b> exists in the Medication Service\r) then (no)
        
        #Pink:Add error <b>OperationOutcome</b> (MEDICATIONSVC_PRESCRIPTION_NO_EXIST) \nor (MEDICATIONSVC_PRESCRIPTION_STATUS) to the <b>Output-Parameters</b>; 
      
      else (yes)

        partition transaction {
        
          :Set all <b>MedicationDispense</b> with the 
          extension[RxPrescriptionProcessIdentifier] equal to <b>RxPrescriptionProcessIdentifier</b> 
          in the Medication Service to Status <b>declined</b>;

          :Set all <b>Medication</b> with the 
          extension[RxPrescriptionProcessIdentifier] equal to <b>RxPrescriptionProcessIdentifier</b>
          to Status <b>inactive</b>;

          :<< Create or Update >> 
          <b>Organization</b>
          <i>from <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>Organization</b></i>
          ====
          identifier[TelematikID] = Value(TelematikID)
          ...;

          partition loop {
            
            repeat: Get next <b>MedicationDispense</b> from the current <b>RxDispensation</b> <b>Input-Parameters</b> part list;
            
            If(\rCheck if the <b>MedicationDispense</b> from the \n <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part in medication[x] \n uses a <b>Data Absent Reason Extension</b>. \n This indicates that the <b>MedicationDispense</b> does not \n reference any <b>Medication</b>\r) then (<b>NOT USE</b> a <b>Data Absent Reason Extension</b>)

              :\rGet the <b>Medication</b> resource referenced by the <b>MedicationDispense</b> \n from the <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part\r;

              :Generate for <b>EPAMedicationUniqueIdentifier</b> from the hashed Input-<b>Medication</b>;
              
              If(\rVerify whether there is a <b>Medication</b> with the <b>RxPrescriptionProcessIdentifier</b> extension \nand\n the generated hash for the <b>EPAMedicationUniqueIdentifier</b> in the Medication Service\r) then (yes)
                
                :Update <b>Medication</b> with <b>RxPrescriptionProcessIdentifier</b> extenstion
                and <b>EPAMedicationUniqueIdentifier</b> to Status <b>active</b>;

              else (no)

                :Generate for <b>RxOriginatorProcessIdentifier</b> from the values of 
                <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>Medication</b>.Id and the Input-<b>PrescriptionId</b>;

                :<< Create >> 
                <b>Medication</b>
                <i>from <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>Medication</b></i>
                ====
                identifier[<b>EPAMedicationUniqueIdentifier</b>] = Value(EPAMedicationUniqueIdentifier)
                identifier[<b>RxOriginatorProcessIdentifier</b>] = Value(RxOriginatorProcessIdentifier)
                extension[<b>RxPrescriptionProcessIdentifier</b>] = Value(RxPrescriptionProcessIdentifier)
                status = <b>active</b>
                ...;

              endif

            else (<b>USE</b> a <b>Data Absent Reason Extension</b>)

              :Use of the <b>Medication</b> instance referenced by the <b>MedicationRequest</b> \n instance with the <b>RxPrescriptionProcessIdentifier</b>;

            endif

            :Generate for <b>RxOriginatorProcessIdentifier</b> from the values of 
            <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>MedicationDispense</b>.Id and the Input-<b>PrescriptionId</b>;

            :<< Create >>
            <b>MedicationDispense</b>
            <i>from <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>MedicationDispense</b></i>
            =====
            identifier[<b>RxOriginatorProcessIdentifier</b>] = Value(RxOriginatorProcessIdentifier)
            extension[<b>RxPrescriptionProcessIdentifier</b>] = Value(RxPrescriptionProcessIdentifier)
            medicationReference = Reference(<b>Medication</b>)
            performer.actor = Reference(<b>Organization</b>)
            authorizingPrescription = Reference(<b>MedicationRequest</b>)
            status = <b>completed</b>;

            repeat while (\rIf next <b>MedicationDispense</b> in <b>Input-Parameters</b> <b>RxDispensation</b> part list exists\r) is (yes) not (no)
          }
          
          :Set <b>MedicationRequest</b> with <b>RxPrescriptionProcessIdentifier</b> 
          to Status <b>completed</b>;

          #PaleGreen:Add information <b>OperationOutcome</b> (MEDICATIONSVC_OPERATION_SUCCESS) to the <b>Output-Parameters</b>;
     
        }
      endif

    else (no)
      
      #Pink:Add error <b>OperationOutcome</b> (NO_VALID_STRUCTURE) to the <b>Output-Parameters</b>;
    
    endif
  
  repeat while (If next <b>Input-Parameters</b> exists) is (yes) not (no)

:Return "<b>Output-Parameters</b>";
stop    
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>