<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1820px" preserveAspectRatio="none" style="width:2373px;height:1820px;background:#FFFFFF;" version="1.1" viewBox="0 0 2373 1820" width="2373px" zoomAndPan="magnify"><defs/><g><rect fill="#87CEEB" height="26.2969" id="_title" style="stroke:#808080;stroke-width:1.0;" width="220" x="1075.375" y="15"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1080.375" y="32.9951">$provide-dispensation-erp</text><ellipse cx="1387.25" cy="57.2969" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="769" x="1002.75" y="141.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="69" x="1012.75" y="162.4043">Validate all</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1085.75" y="162.4043">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1163.75" y="162.4043">,</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1171.75" y="162.4043">Organization</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="1268.75" y="162.4043">and</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1296.75" y="162.4043">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="28" x="1444.75" y="162.4043">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1476.75" y="162.4043">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="1601.75" y="162.4043">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1621.75" y="162.4043">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="30" x="1731.75" y="162.4043">.part</text><polygon fill="#F1F1F1" points="1325.75,195.2344,1448.75,195.2344,1460.75,207.2344,1448.75,219.2344,1325.75,219.2344,1313.75,207.2344,1325.75,195.2344" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="1325.75" y="211.0425">Validation successfull</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1293.75" y="204.6401">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1460.75" y="204.6401">no</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="452" x="478.5" y="229.2344"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="503" y="250.373">Generate</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="566" y="250.373">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="113" x="793" y="250.373">from the values of</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="488.5" y="264.3418">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="613.5" y="264.3418">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="633.5" y="264.3418">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="743.5" y="264.3418">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="86" x="777.5" y="264.3418">authoredOn</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="49" x="867.5" y="264.3418">and the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="513.5" y="278.3105">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="638.5" y="278.3105">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="658.5" y="278.3105">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="768.5" y="278.3105">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="802.5" y="278.3105">PresciptionId</text><polygon fill="#F1F1F1" points="460,311.1406,949,311.1406,961,330.3477,949,349.5547,460,349.5547,448,330.3477,460,311.1406" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="460" y="321.3511">Check if there is a</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123" x="568" y="321.3511">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="45" x="695" y="321.3511">with the</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="201" x="744" y="321.3511">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="945" y="321.3511"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="694" y="334.1558">and</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="86" x="536" y="346.9604">the status NOT</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="67" x="626" y="346.9604">completed</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="180" x="697" y="346.9604">exists in the Medication Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="428" y="327.7534">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="961" y="327.7534">yes</text><rect fill="#FFC0CB" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="541" x="11" y="359.5547"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="21" y="380.6934">Add error</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="135" x="84" y="380.6934">OperationOutcome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="177" x="223" y="380.6934">(NO_EXIST or STATUS) to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="404" y="380.6934">Output-Parameters</text><rect fill="none" height="1237.8203" style="stroke:#000000;stroke-width:1.5;" width="1192" x="572" y="359.5547"/><path d="M659,359.5547 L659,368.8516 L649,378.8516 L572,378.8516 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="575" y="373.5498">transaction</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="572" x="841.5" y="395.8516"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39" x="1007" y="416.9902">Set all</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1050" y="416.9902">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="1198" y="416.9902">with the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="321" x="851.5" y="430.959">extension[RxPrescriptionProcessIdentifier] equal to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="1176.5" y="430.959">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1399.5" y="430.959"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="219" x="986" y="444.9277">in the Medication Service to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="60" x="1209" y="444.9277">declined</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="568" x="843.5" y="477.7578"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39" x="1040" y="498.8965">Set all</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1083" y="498.8965">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="1165" y="498.8965">with the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="321" x="853.5" y="512.8652">extension[RxPrescriptionProcessIdentifier] equal to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="1178.5" y="512.8652">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="1069" y="526.834">to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="55" x="1131" y="526.834">inactive</text><rect fill="#F1F1F1" height="99.8438" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="434" x="910.5" y="559.6641"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="157" x="1049" y="580.8027">&lt;&lt; Create or Update &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1081" y="594.7715">Organization</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="920.5" y="608.7402">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="125" x="952.5" y="608.7402">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="20" x="1077.5" y="608.7402">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1097.5" y="608.7402">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1207.5" y="608.7402">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1241.5" y="608.7402">Organization</text><line style="stroke:#181818;stroke-width:1.0;" x1="910.5" x2="1344.5" y1="616.5703" y2="616.5703"/><line style="stroke:#181818;stroke-width:1.0;" x1="910.5" x2="1344.5" y1="618.5703" y2="618.5703"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="272" x="991.5" y="632.709">identifier[TelematikID] = Value(TelematikID)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="1121.5" y="646.6777">...</text><rect fill="none" height="793.9609" style="stroke:#000000;stroke-width:1.5;" width="1172" x="582" y="669.5078"/><path d="M622,669.5078 L622,678.8047 L612,688.8047 L582,688.8047 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="585" y="683.5029">loop</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="822" x="716.5" y="759.7734"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="47" x="726.5" y="780.9121">Get the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="777.5" y="780.9121">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="175" x="859.5" y="780.9121">Resource referenced by the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1038.5" y="780.9121">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="1186.5" y="780.9121">from the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1243.5" y="780.9121">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="1368.5" y="780.9121">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1388.5" y="780.9121">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="30" x="1498.5" y="780.9121">.part</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="549" x="853" y="813.7422"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="863" y="834.8809">Generate for</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="219" x="947" y="834.8809">EPAMedicationUniqueIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="144" x="1170" y="834.8809">from the hashed Input-</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1314" y="834.8809">Medication</text><polygon fill="#F1F1F1" points="861,867.7109,1394,867.7109,1406,886.918,1394,906.125,861,906.125,849,886.918,861,867.7109" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="141" x="861" y="877.9214">Verify whether there is a</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="71" x="1006" y="877.9214">Medication</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="45" x="1081" y="877.9214">with the</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="201" x="1130" y="877.9214">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="55" x="1335" y="877.9214">extension</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="1117" y="890.7261">and</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="154" x="878" y="903.5308">the generated hash for the</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="199" x="1036" y="903.5308">EPAMedicationUniqueIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="1239" y="903.5308">in the Medication Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="829" y="884.3237">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1406" y="884.3237">no</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="474" x="602" y="916.125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="46" x="612" y="937.2637">Update</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="662" y="937.2637">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="25" x="744" y="937.2637">with</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="773" y="937.2637">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="66" x="1000" y="937.2637">extenstion</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="661.5" y="951.2324">and</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="219" x="689.5" y="951.2324">EPAMedicationUniqueIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="912.5" y="951.2324">to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="42" x="974.5" y="951.2324">active</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="588" x="1122" y="916.125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="1210.5" y="937.2637">Generate for</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1294.5" y="937.2637">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="113" x="1508.5" y="937.2637">from the values of</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1132" y="951.2324">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="1257" y="951.2324">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1277" y="951.2324">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="1387" y="951.2324">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1421" y="951.2324">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="108" x="1499" y="951.2324">.Id and the Input-</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1607" y="951.2324">PresciptionId</text><rect fill="#F1F1F1" height="141.75" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="571" x="1130.5" y="984.0625"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="90" x="1371" y="1005.2012">&lt;&lt; Create &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1377" y="1019.1699">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="1216.5" y="1033.1387">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1248.5" y="1033.1387">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="20" x="1373.5" y="1033.1387">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1393.5" y="1033.1387">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1503.5" y="1033.1387">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1537.5" y="1033.1387">Medication</text><line style="stroke:#181818;stroke-width:1.0;" x1="1130.5" x2="1701.5" y1="1040.9688" y2="1040.9688"/><line style="stroke:#181818;stroke-width:1.0;" x1="1130.5" x2="1701.5" y1="1042.9688" y2="1042.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="1147" y="1057.1074">identifier[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="219" x="1207" y="1057.1074">EPAMedicationUniqueIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="259" x="1426" y="1057.1074">] = Value(EPAMedicationUniqueIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="1156.5" y="1071.0762">identifier[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1216.5" y="1071.0762">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="249" x="1426.5" y="1071.0762">] = Value(RxOriginatorProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="66" x="1140.5" y="1085.0449">extension[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="1206.5" y="1085.0449">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="262" x="1429.5" y="1085.0449">] = Value(RxPrescriptionProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="54" x="1366" y="1099.0137">status =</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="42" x="1424" y="1099.0137">active</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="1410" y="1112.9824">...</text><polygon fill="#F1F1F1" points="1127.5,1131.8125,1139.5,1143.8125,1127.5,1155.8125,1115.5,1143.8125,1127.5,1131.8125" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="654" x="800.5" y="1175.8125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="922" y="1196.9512">Generate for</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="1006" y="1196.9512">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="113" x="1220" y="1196.9512">from the values of</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="810.5" y="1210.9199">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="935.5" y="1210.9199">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="955.5" y="1210.9199">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="1065.5" y="1210.9199">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1099.5" y="1210.9199">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="108" x="1243.5" y="1210.9199">.Id and the Input-</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1351.5" y="1210.9199">PresciptionId</text><rect fill="#F1F1F1" height="155.7188" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="571" x="842" y="1243.75"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="90" x="1082.5" y="1264.8887">&lt;&lt; Create &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1055.5" y="1278.8574">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="895" y="1292.8262">from</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="125" x="927" y="1292.8262">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="20" x="1052" y="1292.8262">[x].</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1072" y="1292.8262">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1182" y="1292.8262">.part.</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="144" x="1216" y="1292.8262">MedicationDispense</text><line style="stroke:#181818;stroke-width:1.0;" x1="842" x2="1413" y1="1300.6563" y2="1300.6563"/><line style="stroke:#181818;stroke-width:1.0;" x1="842" x2="1413" y1="1302.6563" y2="1302.6563"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="868" y="1316.7949">identifier[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="210" x="928" y="1316.7949">RxOriginatorProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="249" x="1138" y="1316.7949">] = Value(RxOriginatorProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="66" x="852" y="1330.7637">extension[</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="918" y="1330.7637">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="262" x="1141" y="1330.7637">] = Value(RxPrescriptionProcessIdentifier)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="220" x="976" y="1344.7324">medicationReference = Reference(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="78" x="1196" y="1344.7324">Medication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1274" y="1344.7324">)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="186" x="985.5" y="1358.7012">performer.actor = Reference(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93" x="1171.5" y="1358.7012">Organization</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1264.5" y="1358.7012">)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="231" x="941" y="1372.6699">authorizingPrescription = Reference(</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1172" y="1372.6699">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1309" y="1372.6699">)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="54" x="1061.5" y="1386.6387">status =</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="74" x="1119.5" y="1386.6387">completed</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="627" x="814" y="705.8047"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="828" y="726.9434">Get next</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="144" x="885" y="726.9434">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="103" x="1033" y="726.9434">from the current</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1140" y="726.9434">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1250" y="726.9434"> </text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1254" y="726.9434">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="48" x="1383" y="726.9434">part list</text><polygon fill="#F1F1F1" points="881.5,1419.4688,1373.5,1419.4688,1385.5,1431.4688,1373.5,1443.4688,881.5,1443.4688,869.5,1431.4688,881.5,1419.4688" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1131.5" y="1453.6792">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="881.5" y="1435.2769">If next</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130" x="920.5" y="1435.2769">MedicationDispense</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="10" x="1054.5" y="1435.2769">in</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="116" x="1068.5" y="1435.2769">Input-Paramerters</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1184.5" y="1435.2769"> </text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99" x="1188.5" y="1435.2769">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="82" x="1291.5" y="1435.2769">part list exists</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1385.5" y="1428.8745">yes</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="438" x="908.5" y="1483.4688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="21" x="918.5" y="1504.6074">Set</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="137" x="943.5" y="1504.6074">MedicationRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="25" x="1084.5" y="1504.6074">with</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="223" x="1113.5" y="1504.6074">RxPrescriptionProcessIdentifier</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="1059.5" y="1518.5762">to Status</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="74" x="1121.5" y="1518.5762">completed</text><rect fill="#98FB98" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="513" x="871" y="1551.4063"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99" x="881" y="1572.5449">Add information</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="135" x="984" y="1572.5449">OperationOutcome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="109" x="1123" y="1572.5449">(SUCCESS) to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="1236" y="1572.5449">Output-Parameters</text><polygon fill="#F1F1F1" points="704.5,1603.375,716.5,1615.375,704.5,1627.375,692.5,1615.375,704.5,1603.375" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="552" x="1781.75" y="229.2344"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="1791.75" y="250.373">Add error</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="135" x="1854.75" y="250.373">OperationOutcome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="188" x="1993.75" y="250.373">(NO_VALID_STRUCTURE) to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="2185.75" y="250.373">Output-Parameters</text><polygon fill="#F1F1F1" points="1387.25,1633.375,1399.25,1645.375,1387.25,1657.375,1375.25,1645.375,1387.25,1633.375" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="373" x="1200.75" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="1210.75" y="108.4355">Get next</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1267.75" y="108.4355">RxDispensation</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="1381.75" y="108.4355">from the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="125" x="1438.75" y="108.4355">Input-Parameters</text><polygon fill="#F1F1F1" points="1293.25,1677.375,1481.25,1677.375,1493.25,1689.375,1481.25,1701.375,1293.25,1701.375,1281.25,1689.375,1293.25,1677.375" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1391.25" y="1711.5854">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="1293.25" y="1693.1831">If next</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="111" x="1332.25" y="1693.1831">Input-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="1447.25" y="1693.1831">exists</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1493.25" y="1686.7808">yes</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="214" x="1280.25" y="1733.0854"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="51" x="1290.25" y="1754.2241">Return "</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="138" x="1341.25" y="1754.2241">Output-Parameters</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="5" x="1479.25" y="1754.2241">"</text><ellipse cx="1387.25" cy="1798.0542" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="1387.25" cy="1798.0542" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="457.7578" y2="477.7578"/><polygon fill="#181818" points="1123.5,467.7578,1127.5,477.7578,1131.5,467.7578,1127.5,471.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="539.6641" y2="559.6641"/><polygon fill="#181818" points="1123.5,549.6641,1127.5,559.6641,1131.5,549.6641,1127.5,553.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="793.7422" y2="813.7422"/><polygon fill="#181818" points="1123.5,803.7422,1127.5,813.7422,1131.5,803.7422,1127.5,807.7422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1416" x2="1416" y1="964.0625" y2="984.0625"/><polygon fill="#181818" points="1412,974.0625,1416,984.0625,1420,974.0625,1416,978.0625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="849" x2="839" y1="886.918" y2="886.918"/><line style="stroke:#181818;stroke-width:1.0;" x1="839" x2="839" y1="886.918" y2="916.125"/><polygon fill="#181818" points="835,906.125,839,916.125,843,906.125,839,910.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1406" x2="1416" y1="886.918" y2="886.918"/><line style="stroke:#181818;stroke-width:1.0;" x1="1416" x2="1416" y1="886.918" y2="916.125"/><polygon fill="#181818" points="1412,906.125,1416,916.125,1420,906.125,1416,910.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="839" x2="839" y1="964.0625" y2="1143.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="839" x2="1115.5" y1="1143.8125" y2="1143.8125"/><polygon fill="#181818" points="1105.5,1139.8125,1115.5,1143.8125,1105.5,1147.8125,1109.5,1143.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1416" x2="1416" y1="1125.8125" y2="1143.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1416" x2="1139.5" y1="1143.8125" y2="1143.8125"/><polygon fill="#181818" points="1149.5,1139.8125,1139.5,1143.8125,1149.5,1147.8125,1145.5,1143.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="847.7109" y2="867.7109"/><polygon fill="#181818" points="1123.5,857.7109,1127.5,867.7109,1131.5,857.7109,1127.5,861.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="1155.8125" y2="1175.8125"/><polygon fill="#181818" points="1123.5,1165.8125,1127.5,1175.8125,1131.5,1165.8125,1127.5,1169.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="1223.75" y2="1243.75"/><polygon fill="#181818" points="1123.5,1233.75,1127.5,1243.75,1131.5,1233.75,1127.5,1237.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="739.7734" y2="759.7734"/><polygon fill="#181818" points="1123.5,749.7734,1127.5,759.7734,1131.5,749.7734,1127.5,753.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1385.5" x2="1732" y1="1431.4688" y2="1431.4688"/><polygon fill="#181818" points="1728,1079.6289,1732,1069.6289,1736,1079.6289,1732,1075.6289" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1732" x2="1732" y1="722.7891" y2="1431.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="1732" x2="1441" y1="722.7891" y2="722.7891"/><polygon fill="#181818" points="1451,718.7891,1441,722.7891,1451,726.7891,1447,722.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="1399.4688" y2="1419.4688"/><polygon fill="#181818" points="1123.5,1409.4688,1127.5,1419.4688,1131.5,1409.4688,1127.5,1413.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="659.5078" y2="705.8047"/><polygon fill="#181818" points="1123.5,695.8047,1127.5,705.8047,1131.5,695.8047,1127.5,699.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="1443.4688" y2="1483.4688"/><polygon fill="#181818" points="1123.5,1473.4688,1127.5,1483.4688,1131.5,1473.4688,1127.5,1477.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="1531.4063" y2="1551.4063"/><polygon fill="#181818" points="1123.5,1541.4063,1127.5,1551.4063,1131.5,1541.4063,1127.5,1545.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="448" x2="281.5" y1="330.3477" y2="330.3477"/><line style="stroke:#181818;stroke-width:1.0;" x1="281.5" x2="281.5" y1="330.3477" y2="359.5547"/><polygon fill="#181818" points="277.5,349.5547,281.5,359.5547,285.5,349.5547,281.5,353.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="961" x2="1127.5" y1="330.3477" y2="330.3477"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="330.3477" y2="395.8516"/><polygon fill="#181818" points="1123.5,385.8516,1127.5,395.8516,1131.5,385.8516,1127.5,389.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="281.5" x2="281.5" y1="393.5234" y2="1615.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="281.5" x2="692.5" y1="1615.375" y2="1615.375"/><polygon fill="#181818" points="682.5,1611.375,692.5,1615.375,682.5,1619.375,686.5,1615.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="1127.5" y1="1585.375" y2="1615.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="1127.5" x2="716.5" y1="1615.375" y2="1615.375"/><polygon fill="#181818" points="726.5,1611.375,716.5,1615.375,726.5,1619.375,722.5,1615.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="704.5" x2="704.5" y1="291.1406" y2="311.1406"/><polygon fill="#181818" points="700.5,301.1406,704.5,311.1406,708.5,301.1406,704.5,305.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1313.75" x2="704.5" y1="207.2344" y2="207.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="704.5" x2="704.5" y1="207.2344" y2="229.2344"/><polygon fill="#181818" points="700.5,219.2344,704.5,229.2344,708.5,219.2344,704.5,223.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1460.75" x2="2057.75" y1="207.2344" y2="207.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="2057.75" x2="2057.75" y1="207.2344" y2="229.2344"/><polygon fill="#181818" points="2053.75,219.2344,2057.75,229.2344,2061.75,219.2344,2057.75,223.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="704.5" x2="704.5" y1="1627.375" y2="1645.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="704.5" x2="1375.25" y1="1645.375" y2="1645.375"/><polygon fill="#181818" points="1365.25,1641.375,1375.25,1645.375,1365.25,1649.375,1369.25,1645.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2057.75" x2="2057.75" y1="263.2031" y2="1645.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="2057.75" x2="1399.25" y1="1645.375" y2="1645.375"/><polygon fill="#181818" points="1409.25,1641.375,1399.25,1645.375,1409.25,1649.375,1405.25,1645.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1387.25" x2="1387.25" y1="175.2344" y2="195.2344"/><polygon fill="#181818" points="1383.25,185.2344,1387.25,195.2344,1391.25,185.2344,1387.25,189.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1387.25" x2="1387.25" y1="121.2656" y2="141.2656"/><polygon fill="#181818" points="1383.25,131.2656,1387.25,141.2656,1391.25,131.2656,1387.25,135.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1493.25" x2="2347.75" y1="1689.375" y2="1689.375"/><polygon fill="#181818" points="2343.75,890.8281,2347.75,880.8281,2351.75,890.8281,2347.75,886.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2347.75" x2="2347.75" y1="104.2813" y2="1689.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="2347.75" x2="1573.75" y1="104.2813" y2="104.2813"/><polygon fill="#181818" points="1583.75,100.2813,1573.75,104.2813,1583.75,108.2813,1579.75,104.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1387.25" x2="1387.25" y1="1657.375" y2="1677.375"/><polygon fill="#181818" points="1383.25,1667.375,1387.25,1677.375,1391.25,1667.375,1387.25,1671.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1387.25" x2="1387.25" y1="67.2969" y2="87.2969"/><polygon fill="#181818" points="1383.25,77.2969,1387.25,87.2969,1391.25,77.2969,1387.25,81.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1387.25" x2="1387.25" y1="1701.375" y2="1733.0854"/><polygon fill="#181818" points="1383.25,1723.0854,1387.25,1733.0854,1391.25,1723.0854,1387.25,1727.0854" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1387.25" x2="1387.25" y1="1767.0542" y2="1787.0542"/><polygon fill="#181818" points="1383.25,1777.0542,1387.25,1787.0542,1391.25,1777.0542,1387.25,1781.0542" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[027b46c69b904144420a69cf91f513c6]
@startuml operation.provide-dispensation-erp
skinparam defaultTextAlignment center
skinparam title {
  backgroundColor SkyBlue
  borderColor Gray
} 
title $provide-dispensation-erp

start

  repeat:Get next <b>RxDispensation</b> from the <b>Input-Parameters</b>;
  
    :Validate all <b>Medication</b>, <b>Organization</b> and <b>MedicationDispense</b> from <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part;

    if (Validation successfull) then (yes)
      
      :Generate <b>RxPrescriptionProcessIdentifier</b> from the values of 
      <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>authoredOn</b> and the 
      <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>PresciptionId</b>;


      if(Check if there is a <b>MedicationRequest</b> with the <b>RxPrescriptionProcessIdentifier</b> \n and \n the status NOT <b>completed</b> exists in the Medication Service) then (yes)
        
        #Pink:Add error <b>OperationOutcome</b> (NO_EXIST or STATUS) to the <b>Output-Parameters</b>; 
      
      else (yes)

        partition transaction {
        
          :Set all <b>MedicationDispense</b> with the 
          extension[RxPrescriptionProcessIdentifier] equal to <b>RxPrescriptionProcessIdentifier</b> 
          in the Medication Service to Status <b>declined</b>;

          :Set all <b>Medication</b> with the 
          extension[RxPrescriptionProcessIdentifier] equal to <b>RxPrescriptionProcessIdentifier</b>
          to Status <b>inactive</b>;

          :<< Create or Update >> 
          <b>Organization</b>
          <i>from <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>Organization</b></i>
          ====
          identifier[TelematikID] = Value(TelematikID)
          ...;

          partition loop {
            
            repeat: Get next <b>MedicationDispense</b> from the current <b>RxDispensation</b> <b>Input-Parameters</b> part list;

            :Get the <b>Medication</b> Resource referenced by the <b>MedicationDispense</b> from the <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part;

            :Generate for <b>EPAMedicationUniqueIdentifier</b> from the hashed Input-<b>Medication</b>;
            
            If(Verify whether there is a <b>Medication</b> with the <b>RxPrescriptionProcessIdentifier</b> extension \nand\n the generated hash for the <b>EPAMedicationUniqueIdentifier</b> in the Medication Service) then (yes)
              
              :Update <b>Medication</b> with <b>RxPrescriptionProcessIdentifier</b> extenstion
              and <b>EPAMedicationUniqueIdentifier</b> to Status <b>active</b>;

            else (no)

              :Generate for <b>RxOriginatorProcessIdentifier</b> from the values of 
              <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>Medication</b>.Id and the Input-<b>PresciptionId</b>;

              :<< Create >> 
              <b>Medication</b>
              <i>from <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>Medication</b></i>
              ====
              identifier[<b>EPAMedicationUniqueIdentifier</b>] = Value(EPAMedicationUniqueIdentifier)
              identifier[<b>RxOriginatorProcessIdentifier</b>] = Value(RxOriginatorProcessIdentifier)
              extension[<b>RxPrescriptionProcessIdentifier</b>] = Value(RxPrescriptionProcessIdentifier)
              status = <b>active</b>
              ...;

            endif

            :Generate for <b>RxOriginatorProcessIdentifier</b> from the values of 
            <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>MedicationDispense</b>.Id and the Input-<b>PresciptionId</b>;

            :<< Create >>
            <b>MedicationDispense</b>
            <i>from <b>Input-Parameters</b>[x].<b>RxDispensation</b>.part.<b>MedicationDispense</b></i>
            =====
            identifier[<b>RxOriginatorProcessIdentifier</b>] = Value(RxOriginatorProcessIdentifier)
            extension[<b>RxPrescriptionProcessIdentifier</b>] = Value(RxPrescriptionProcessIdentifier)
            medicationReference = Reference(<b>Medication</b>)
            performer.actor = Reference(<b>Organization</b>)
            authorizingPrescription = Reference(<b>MedicationRequest</b>)
            status = <b>completed</b>;

            repeat while (If next <b>MedicationDispense</b> in <b>Input-Paramerters</b> <b>RxDispensation</b> part list exists) is (yes) not (no)
          }
          
          :Set <b>MedicationRequest</b> with <b>RxPrescriptionProcessIdentifier</b> 
          to Status <b>completed</b>;

          #PaleGreen:Add information <b>OperationOutcome</b> (SUCCESS) to the <b>Output-Parameters</b>;
     
        }
      endif

    else (no)
      
      #Pink:Add error <b>OperationOutcome</b> (NO_VALID_STRUCTURE) to the <b>Output-Parameters</b>;
    
    endif
  
  repeat while (If next <b>Input-Parameters</b> exists) is (yes) not (no)

:Return "<b>Output-Parameters</b>";
stop    
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>